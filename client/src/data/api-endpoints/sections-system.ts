import { createElement } from 'react';
import { Zap, Shield, Wind, BarChart3, Clock, Cpu } from 'lucide-react';
import type { ApiSection } from './types';

const icon = (Icon: React.ComponentType<{ className?: string }>) =>
  createElement(Icon, { className: 'w-5 h-5' });

export const systemSections: ApiSection[] = [
  {
    title: 'Power Management',
    icon: icon(Zap),
    endpoints: [
      {
        method: 'GET',
        path: '/api/power/status',
        description: 'Get Current Power Status',
        requiresAuth: true,
        response: '{ "current_profile": "balanced", "cpu_freq_mhz": 3800, "auto_scaling_enabled": true }',
      },
      {
        method: 'GET',
        path: '/api/power/profiles',
        description: 'Get Available Power Profiles',
        requiresAuth: true,
        response: `{
  "profiles": [
    { "name": "powersave", "governor": "powersave", "min_freq_mhz": 800, "max_freq_mhz": 2400 },
    { "name": "balanced", "governor": "powersave", "min_freq_mhz": 800, "max_freq_mhz": 3800 },
    { "name": "performance", "governor": "performance", "min_freq_mhz": 3800, "max_freq_mhz": 3800 }
  ],
  "current_profile": "balanced"
}`,
      },
      {
        method: 'POST',
        path: '/api/power/profile',
        description: 'Set Power Profile (Admin)',
        requiresAuth: true,
        body: [
          { field: 'profile', type: 'string', required: true, description: 'Profile name: powersave/balanced/performance' },
          { field: 'reason', type: 'string', required: false, description: 'Reason for change' },
          { field: 'duration_seconds', type: 'integer', required: false, description: 'Override duration (null = permanent)' },
        ],
        response: '{ "success": true, "previous_profile": "balanced", "new_profile": "performance" }',
      },
      { method: 'GET', path: '/api/power/demands', description: 'Get Active Power Demands', requiresAuth: true, response: '[{ "source": "raid_resync", "profile": "performance" }]' },
      {
        method: 'POST',
        path: '/api/power/demands',
        description: 'Register Power Demand',
        requiresAuth: true,
        body: [
          { field: 'source', type: 'string', required: true, description: 'Demand source (e.g., "raid_resync")' },
          { field: 'reason', type: 'string', required: false, description: 'Human-readable reason' },
        ],
        response: '{ "success": true, "demand_id": "demand_abc123", "profile_changed": true }',
      },
      {
        method: 'DELETE',
        path: '/api/power/demands',
        description: 'Unregister Power Demand',
        requiresAuth: true,
        body: [{ field: 'demand_id', type: 'string', required: true, description: 'Demand ID from register' }],
        response: '{ "success": true, "profile_changed": false }',
      },
      { method: 'GET', path: '/api/power/intensities', description: 'Get Service Intensities', requiresAuth: true, response: '{ "services": [{ "name": "raid", "intensity": "high" }] }' },
      { method: 'GET', path: '/api/power/history', description: 'Get Power History', requiresAuth: true, response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/power/auto-scaling', description: 'Get Auto-Scaling Config', requiresAuth: true, response: '{ "enabled": true, "idle_profile": "powersave" }' },
      { method: 'PUT', path: '/api/power/auto-scaling', description: 'Update Auto-Scaling Config (Admin)', requiresAuth: true, response: '{ "enabled": true, "idle_profile": "powersave" }' },
      { method: 'GET', path: '/api/power/dynamic-mode', description: 'Get Dynamic Mode Config', requiresAuth: true, response: '{ "enabled": false }' },
      { method: 'PUT', path: '/api/power/dynamic-mode', description: 'Update Dynamic Mode Config (Admin)', requiresAuth: true, response: '{ "enabled": true }' },
      { method: 'POST', path: '/api/power/backend', description: 'Switch Power Backend (Admin)', requiresAuth: true, body: [{ field: 'backend', type: 'string', required: true, description: 'Backend: cpufreq/amd_pstate' }], response: '{ "success": true, "backend": "amd_pstate" }' },
    ],
  },
  {
    title: 'Power Presets',
    icon: icon(Cpu),
    endpoints: [
      { method: 'GET', path: '/api/power/presets/', description: 'List Power Presets', requiresAuth: true, response: '[{ "id": 1, "name": "Silent", "governor": "powersave" }]' },
      { method: 'GET', path: '/api/power/presets/active', description: 'Get Active Preset', requiresAuth: true, response: '{ "id": 2, "name": "Balanced", "is_active": true }' },
      {
        method: 'GET',
        path: '/api/power/presets/{preset_id}',
        description: 'Get Preset Detail',
        requiresAuth: true,
        params: [{ name: 'preset_id', type: 'integer', required: true, description: 'Preset ID' }],
        response: '{ "id": 1, "name": "Silent", "governor": "powersave", "max_freq_mhz": 2400 }',
      },
      {
        method: 'POST',
        path: '/api/power/presets/{preset_id}/activate',
        description: 'Activate Power Preset',
        requiresAuth: true,
        params: [{ name: 'preset_id', type: 'integer', required: true, description: 'Preset ID' }],
        response: '{ "success": true, "activated": "Silent" }',
      },
      {
        method: 'POST',
        path: '/api/power/presets/',
        description: 'Create Power Preset (Admin)',
        requiresAuth: true,
        body: [
          { field: 'name', type: 'string', required: true, description: 'Preset name' },
          { field: 'governor', type: 'string', required: true, description: 'CPU governor' },
          { field: 'max_freq_mhz', type: 'integer', required: false, description: 'Max frequency' },
        ],
        response: '{ "id": 3, "name": "Custom" }',
      },
      {
        method: 'PUT',
        path: '/api/power/presets/{preset_id}',
        description: 'Update Power Preset (Admin)',
        requiresAuth: true,
        params: [{ name: 'preset_id', type: 'integer', required: true, description: 'Preset ID' }],
        response: '{ "id": 1, "name": "Updated Silent" }',
      },
      {
        method: 'DELETE',
        path: '/api/power/presets/{preset_id}',
        description: 'Delete Power Preset (Admin)',
        requiresAuth: true,
        params: [{ name: 'preset_id', type: 'integer', required: true, description: 'Preset ID' }],
        response: '204 No Content',
      },
    ],
  },
  {
    title: 'Energy Monitoring',
    icon: icon(Shield),
    endpoints: [
      {
        method: 'GET',
        path: '/api/energy/dashboard/{device_id}',
        description: 'Get Energy Dashboard for Device',
        requiresAuth: true,
        params: [{ name: 'device_id', type: 'integer', required: true, description: 'Device ID (e.g., Tapo smart plug)' }],
        response: '{ "device_id": 1, "device_name": "Tapo Plug", "current_watts": 4.2, "is_online": true }',
      },
      {
        method: 'GET',
        path: '/api/energy/stats/{device_id}/today',
        description: 'Get Today Energy Stats',
        requiresAuth: true,
        params: [{ name: 'device_id', type: 'integer', required: true, description: 'Device ID' }],
        response: '{ "kwh": 0.15, "avg_watts": 6.2, "peak_watts": 45.0 }',
      },
      {
        method: 'GET',
        path: '/api/energy/stats/{device_id}/week',
        description: 'Get Weekly Energy Stats',
        requiresAuth: true,
        params: [{ name: 'device_id', type: 'integer', required: true, description: 'Device ID' }],
        response: '{ "kwh": 1.05, "avg_watts": 6.3 }',
      },
      {
        method: 'GET',
        path: '/api/energy/stats/{device_id}/month',
        description: 'Get Monthly Energy Stats',
        requiresAuth: true,
        params: [{ name: 'device_id', type: 'integer', required: true, description: 'Device ID' }],
        response: '{ "kwh": 4.5, "avg_watts": 6.1 }',
      },
      {
        method: 'GET',
        path: '/api/energy/cost/{device_id}',
        description: 'Estimate Energy Cost',
        requiresAuth: true,
        params: [
          { name: 'device_id', type: 'integer', required: true, description: 'Device ID' },
          { name: 'period', type: 'string', required: false, description: 'Period: today/week/month' },
        ],
        response: '{ "period": "today", "kwh_consumed": 0.15, "cost": 0.06, "currency": "EUR" }',
      },
      {
        method: 'GET',
        path: '/api/energy/hourly/{device_id}',
        description: 'Get Hourly Power Samples',
        requiresAuth: true,
        params: [
          { name: 'device_id', type: 'integer', required: true, description: 'Device ID' },
          { name: 'hours', type: 'integer', required: false, description: 'Hours of history (default: 24)' },
        ],
        response: '[{ "timestamp": "2026-01-24T01:00:00Z", "avg_watts": 3.5, "min_watts": 2.1, "max_watts": 5.8 }]',
      },
      { method: 'GET', path: '/api/energy/price', description: 'Get Energy Price Config', requiresAuth: true, response: '{ "price_per_kwh": 0.40, "currency": "EUR" }' },
      { method: 'PUT', path: '/api/energy/price', description: 'Update Energy Price Config (Admin)', requiresAuth: true, body: [{ field: 'price_per_kwh', type: 'float', required: true, description: 'Price per kWh' }], response: '{ "price_per_kwh": 0.40, "currency": "EUR" }' },
      {
        method: 'GET',
        path: '/api/energy/cumulative/{device_id}',
        description: 'Get Cumulative Energy Data',
        requiresAuth: true,
        params: [{ name: 'device_id', type: 'integer', required: true, description: 'Device ID' }],
        response: '{ "total_kwh": 125.5, "since": "2025-01-01T00:00:00" }',
      },
    ],
  },
  {
    title: 'Fan Control',
    icon: icon(Wind),
    endpoints: [
      { method: 'GET', path: '/api/fans/status', description: 'Get Fan Status', requiresAuth: true, response: '{ "mode": "auto", "rpm": 850, "pwm": 60, "temperature": 42 }' },
      { method: 'GET', path: '/api/fans/list', description: 'List All Fans', requiresAuth: true, response: '[{ "name": "cpu_fan", "rpm": 850, "pwm": 60 }]' },
      {
        method: 'POST',
        path: '/api/fans/mode',
        description: 'Set Fan Mode',
        requiresAuth: true,
        body: [{ field: 'mode', type: 'string', required: true, description: 'Mode: auto/manual/curve' }],
        response: '{ "mode": "manual", "applied": true }',
      },
      {
        method: 'POST',
        path: '/api/fans/pwm',
        description: 'Set Fan PWM (Manual Mode)',
        requiresAuth: true,
        body: [{ field: 'pwm', type: 'integer', required: true, description: 'PWM value 0-255' }],
        response: '{ "pwm": 128, "applied": true }',
      },
      {
        method: 'PUT',
        path: '/api/fans/curve',
        description: 'Update Fan Curve',
        requiresAuth: true,
        body: [{ field: 'points', type: 'array', required: true, description: 'Array of {temp, pwm} points' }],
        response: '{ "curve": [{ "temp": 30, "pwm": 40 }, { "temp": 70, "pwm": 200 }] }',
      },
      {
        method: 'GET',
        path: '/api/fans/history',
        description: 'Get Fan History',
        requiresAuth: true,
        params: [{ name: 'minutes', type: 'integer', required: false, description: 'Minutes of history (default: 60)' }],
        response: '{ "samples": [{ "timestamp": "...", "rpm": 850, "pwm": 60, "temp": 42 }] }',
      },
      { method: 'POST', path: '/api/fans/backend', description: 'Switch Fan Backend (Admin)', requiresAuth: true, body: [{ field: 'backend', type: 'string', required: true, description: 'Backend: hwmon/ipmi' }], response: '{ "backend": "hwmon", "success": true }' },
      { method: 'GET', path: '/api/fans/permissions', description: 'Get Fan Permissions', requiresAuth: true, response: '{ "can_control": true, "backend": "hwmon" }' },
      { method: 'GET', path: '/api/fans/presets', description: 'Get Fan Presets', requiresAuth: true, response: '{ "presets": [{ "name": "Silent", "pwm": 30 }, { "name": "Performance", "pwm": 100 }] }' },
      {
        method: 'POST',
        path: '/api/fans/preset',
        description: 'Apply Fan Preset',
        requiresAuth: true,
        body: [{ field: 'preset', type: 'string', required: true, description: 'Preset name' }],
        response: '{ "preset": "Silent", "applied": true }',
      },
      {
        method: 'PATCH',
        path: '/api/fans/config',
        description: 'Update Fan Config',
        requiresAuth: true,
        response: '{ "updated": true }',
      },
    ],
  },
  {
    title: 'Monitoring',
    icon: icon(BarChart3),
    endpoints: [
      { method: 'GET', path: '/api/monitoring/cpu/current', description: 'Get Current CPU Metrics', requiresAuth: true, response: '{ "usage_percent": 25.5, "frequency_mhz": 3800, "temperature": 45 }' },
      { method: 'GET', path: '/api/monitoring/cpu/history', description: 'Get CPU History', requiresAuth: true, params: [{ name: 'minutes', type: 'integer', required: false, description: 'Minutes of history' }], response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/monitoring/memory/current', description: 'Get Current Memory Metrics', requiresAuth: true, response: '{ "used": 8589934592, "total": 17179869184, "percent": 50.0 }' },
      { method: 'GET', path: '/api/monitoring/memory/history', description: 'Get Memory History', requiresAuth: true, response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/monitoring/network/current', description: 'Get Current Network Metrics', requiresAuth: true, response: '{ "bytes_sent": 1048576, "bytes_recv": 2097152 }' },
      { method: 'GET', path: '/api/monitoring/network/history', description: 'Get Network History', requiresAuth: true, response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/monitoring/disk-io/current', description: 'Get Current Disk I/O', requiresAuth: true, response: '{ "read_bytes": 4096, "write_bytes": 8192 }' },
      { method: 'GET', path: '/api/monitoring/disk-io/history', description: 'Get Disk I/O History', requiresAuth: true, response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/monitoring/processes/current', description: 'Get Current Processes', requiresAuth: true, response: '{ "processes": [...] }' },
      { method: 'GET', path: '/api/monitoring/processes/history', description: 'Get Process History', requiresAuth: true, response: '{ "samples": [...] }' },
      { method: 'GET', path: '/api/monitoring/config/retention', description: 'Get Retention Config', requiresAuth: true, response: '[{ "metric_type": "cpu", "retention_hours": 168 }]' },
      {
        method: 'PUT',
        path: '/api/monitoring/config/retention/{metric_type}',
        description: 'Update Retention Config (Admin)',
        requiresAuth: true,
        params: [{ name: 'metric_type', type: 'string', required: true, description: 'Metric type: cpu/memory/network/disk_io' }],
        body: [{ field: 'retention_hours', type: 'integer', required: true, description: 'Retention hours' }],
        response: '{ "metric_type": "cpu", "retention_hours": 336 }',
      },
      { method: 'GET', path: '/api/monitoring/stats/database', description: 'Get Monitoring DB Stats', requiresAuth: true, response: '{ "total_samples": 50000, "size_bytes": 10485760 }' },
      { method: 'GET', path: '/api/monitoring/status', description: 'Get Monitoring Status', requiresAuth: true, response: '{ "collectors": [...], "is_running": true }' },
      { method: 'POST', path: '/api/monitoring/cleanup', description: 'Run Monitoring Cleanup (Admin)', requiresAuth: true, response: '{ "deleted_samples": 1000 }' },
    ],
  },
  {
    title: 'Schedulers',
    icon: icon(Clock),
    endpoints: [
      { method: 'GET', path: '/api/schedulers/', description: 'List All Schedulers', requiresAuth: true, response: '[{ "name": "backup_daily", "enabled": true, "next_run": "..." }]' },
      {
        method: 'GET',
        path: '/api/schedulers/{name}',
        description: 'Get Scheduler Detail',
        requiresAuth: true,
        params: [{ name: 'name', type: 'string', required: true, description: 'Scheduler name' }],
        response: '{ "name": "backup_daily", "enabled": true, "cron": "0 2 * * *", "last_run": "..." }',
      },
      {
        method: 'POST',
        path: '/api/schedulers/{name}/run-now',
        description: 'Run Scheduler Now (Admin)',
        requiresAuth: true,
        params: [{ name: 'name', type: 'string', required: true, description: 'Scheduler name' }],
        response: '{ "success": true, "execution_id": "..." }',
      },
      {
        method: 'GET',
        path: '/api/schedulers/{name}/history',
        description: 'Get Scheduler History',
        requiresAuth: true,
        params: [{ name: 'name', type: 'string', required: true, description: 'Scheduler name' }],
        response: '{ "executions": [{ "id": 1, "status": "success", "started_at": "...", "duration_ms": 1200 }] }',
      },
      { method: 'GET', path: '/api/schedulers/history/all', description: 'Get All Scheduler History', requiresAuth: true, response: '{ "executions": [...] }' },
      {
        method: 'PUT',
        path: '/api/schedulers/{name}/config',
        description: 'Update Scheduler Config (Admin)',
        requiresAuth: true,
        params: [{ name: 'name', type: 'string', required: true, description: 'Scheduler name' }],
        response: '{ "name": "backup_daily", "cron": "0 3 * * *" }',
      },
      {
        method: 'POST',
        path: '/api/schedulers/{name}/toggle',
        description: 'Toggle Scheduler (Admin)',
        requiresAuth: true,
        params: [{ name: 'name', type: 'string', required: true, description: 'Scheduler name' }],
        response: '{ "name": "backup_daily", "enabled": false }',
      },
    ],
  },
];
